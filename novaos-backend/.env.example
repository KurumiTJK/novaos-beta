# ═══════════════════════════════════════════════════════════════════════════════
# NOVAOS BACKEND — Environment Configuration
# ═══════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────────
# SERVER
# ─────────────────────────────────────────────────────────────────────────────────
PORT=3000
NODE_ENV=development

# ─────────────────────────────────────────────────────────────────────────────────
# LLM PROVIDERS (at least one required for semantic classification)
# ─────────────────────────────────────────────────────────────────────────────────
OPENAI_API_KEY=your-openai-key-here
GEMINI_API_KEY=your-gemini-key-here

# Provider preference: openai | gemini | mock
PREFERRED_PROVIDER=openai

# Set to true to always use mock responses (for testing)
USE_MOCK_PROVIDER=false

# ═══════════════════════════════════════════════════════════════════════════════
# LIVE DATA ROUTER — Real-time Data Providers
# ═══════════════════════════════════════════════════════════════════════════════

# Stock Market Data — Finnhub (https://finnhub.io/)
# Free tier: 60 API calls/minute
FINNHUB_API_KEY=your-finnhub-key-here

# Weather Data — OpenWeatherMap (https://openweathermap.org/api)
# Free tier: 1,000 calls/day, 60 calls/minute
OPENWEATHERMAP_API_KEY=your-openweathermap-key-here

# NOTE: The following providers require NO API keys:
# - CoinGecko (crypto) — Free tier with rate limiting
# - Frankfurter (FX)   — Free, no authentication
# - Time Provider      — Uses system clock

# ═══════════════════════════════════════════════════════════════════════════════
# SEARCH PROVIDERS (for Lens verification)
# ═══════════════════════════════════════════════════════════════════════════════

# Tavily — Primary search for MEDIUM tier (https://tavily.com/)
TAVILY_API_KEY=tvly-...

# Google Custom Search Engine — Fallback/HIGH tier verification
# Get API key: https://developers.google.com/custom-search/v1/introduction
# Create CSE: https://programmablesearchengine.google.com/
GOOGLE_CSE_API_KEY=AIza...
GOOGLE_CSE_ID=abc123...

# ─────────────────────────────────────────────────────────────────────────────────
# LENS SEARCH CONFIGURATION
# ─────────────────────────────────────────────────────────────────────────────────
# LENS_MEDIUM_TIMEOUT_MS=3000
# LENS_HIGH_TIMEOUT_MS=5000
# LENS_HIGH_MIN_SOURCES=2
# LENS_REQUIRE_OFFICIAL=true

# ═══════════════════════════════════════════════════════════════════════════════
# AUTHENTICATION
# ═══════════════════════════════════════════════════════════════════════════════
JWT_SECRET=change-this-to-a-secure-random-string-in-production
JWT_EXPIRY=24h

# Set to true to require authentication for all endpoints
REQUIRE_AUTH=false

# ═══════════════════════════════════════════════════════════════════════════════
# PERSISTENCE — Redis
# ═══════════════════════════════════════════════════════════════════════════════

# Redis Configuration (optional - falls back to in-memory if unavailable)
REDIS_URL=redis://localhost:6379

# Set to true to force in-memory storage even if Redis is available
DISABLE_REDIS=false

# ═══════════════════════════════════════════════════════════════════════════════
# SECURITY — Encryption & Integrity
# ═══════════════════════════════════════════════════════════════════════════════

# Encryption key for data at rest (AES-256-GCM)
# Generate: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# REQUIRED in production for EncryptionService
ENCRYPTION_KEY=

# HMAC secret for secure store integrity verification
# Generate: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# REQUIRED in production (throws error if missing)
# Optional in development (uses fallback with warning)
STORE_HMAC_SECRET=

# HMAC key for resource discovery integrity (optional, separate from store)
# NOVA_HMAC_KEY=

# ═══════════════════════════════════════════════════════════════════════════════
# VERIFICATION & WEB FETCH
# ═══════════════════════════════════════════════════════════════════════════════

# Enable verification capability (requires WEB_FETCH_ENABLED=true)
VERIFICATION_ENABLED=false
# If true, requests requiring verification will fail without it
VERIFICATION_REQUIRED=false
# Cache TTL for verification results (seconds)
VERIFICATION_CACHE_TTL_SECONDS=300
# Max verifications per request
VERIFICATION_MAX_PER_REQUEST=3
# Trusted domains (comma-separated)
VERIFICATION_TRUSTED_DOMAINS=wikipedia.org,gov,edu,reuters.com,apnews.com

# Web Fetch Configuration (must be enabled for verification)
WEB_FETCH_ENABLED=false
# Domain allowlist (empty = allow all except blocklist)
WEB_FETCH_ALLOWLIST=
# Domain blocklist (always applied)
WEB_FETCH_BLOCKLIST=localhost,127.0.0.1,0.0.0.0,169.254.169.254,metadata.google.internal
# Max response size (bytes)
WEB_FETCH_MAX_SIZE_BYTES=1048576
# Max redirects to follow
WEB_FETCH_MAX_REDIRECTS=3
# Timeouts (ms)
WEB_FETCH_CONNECT_TIMEOUT_MS=5000
WEB_FETCH_READ_TIMEOUT_MS=10000
WEB_FETCH_TOTAL_TIMEOUT_MS=15000
WEB_FETCH_DNS_TIMEOUT_MS=3000
# Security (keep these true in production!)
WEB_FETCH_ALLOW_PRIVATE_IPS=false
WEB_FETCH_ALLOW_LOCALHOST=false
WEB_FETCH_VALIDATE_CERTS=true
WEB_FETCH_PREVENT_DNS_REBINDING=true

# ═══════════════════════════════════════════════════════════════════════════════
# OBSERVABILITY
# ═══════════════════════════════════════════════════════════════════════════════

# Enable debug logging
DEBUG=false
# Redact PII in logs (keep true in production!)
REDACT_PII=true

# ═══════════════════════════════════════════════════════════════════════════════
# RATE LIMITING
# ═══════════════════════════════════════════════════════════════════════════════

# Rate limit multiplier (1.0 = normal, 0.5 = stricter, 2.0 = relaxed)
RATE_LIMIT_MULTIPLIER=1.0

# ═══════════════════════════════════════════════════════════════════════════════
# STAGING MODE
# These settings are applied automatically when NODE_ENV=staging
# ═══════════════════════════════════════════════════════════════════════════════

# Override models in staging (cheaper options)
# STAGING_OPENAI_MODEL=gpt-4o-mini
# STAGING_GEMINI_MODEL=gemini-1.5-flash
# STAGING_MAX_REQUESTS_PER_MINUTE=30
# STAGING_MAX_TOKENS_PER_REQUEST=1000
# STAGING_MAX_CONVERSATION_MESSAGES=20
# STAGING_REQUEST_TIMEOUT_MS=15000
# STAGING_DISABLE_VERIFICATION=true
# STAGING_DISABLE_WEB_FETCH=true

# ═══════════════════════════════════════════════════════════════════════════════
# PRODUCTION OVERRIDES
# ═══════════════════════════════════════════════════════════════════════════════

# OPENAI_MODEL=gpt-4o
# GEMINI_MODEL=gemini-1.5-pro
# MAX_REQUESTS_PER_MINUTE=60
# MAX_TOKENS_PER_REQUEST=4000

# CORS (comma-separated for production)
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

